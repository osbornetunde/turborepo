"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ssr = exports.plugin = void 0;
exports.default = plugin;
const utils_1 = require("./utils");
const buildConfig_1 = require("./plugins/buildConfig");
const previewConfig_1 = require("./plugins/previewConfig");
const autoFullBuild_1 = require("./plugins/autoFullBuild");
const devConfig_1 = require("./plugins/devConfig");
const manifest_1 = require("./plugins/manifest");
const packageJsonFile_1 = require("./plugins/packageJsonFile");
const removeRequireHookPlugin_1 = require("./plugins/removeRequireHookPlugin");
const importUserCode_1 = require("./plugins/importUserCode");
const config_1 = require("./plugins/config");
const distFileNames_1 = require("./plugins/distFileNames");
const extractAssetsPlugin_1 = require("./plugins/extractAssetsPlugin");
const extractExportNamesPlugin_1 = require("./plugins/extractExportNamesPlugin");
const suppressRollupWarning_1 = require("./plugins/suppressRollupWarning");
const setGlobalContext_1 = require("./plugins/setGlobalContext");
const importBuild_1 = require("./plugins/importBuild");
const commonConfig_1 = require("./plugins/commonConfig");
const extensionsAssets_1 = require("./plugins/extensionsAssets");
const baseUrls_1 = require("./plugins/baseUrls");
(0, utils_1.markEnvAsPlugin)();
// Return as `any` to avoid Plugin type mismatches when there are multiple Vite versions installed
function plugin(vpsConfig) {
    const plugins = [
        (0, config_1.resolveVpsConfig)(vpsConfig),
        ...(0, commonConfig_1.commonConfig)(),
        (0, importUserCode_1.importUserCode)(),
        ...(0, devConfig_1.devConfig)(),
        (0, buildConfig_1.buildConfig)(),
        (0, previewConfig_1.previewConfig)(),
        ...(0, autoFullBuild_1.autoFullBuild)(),
        ...(0, manifest_1.manifest)(),
        (0, packageJsonFile_1.packageJsonFile)(),
        (0, removeRequireHookPlugin_1.removeRequireHookPlugin)(),
        (0, distFileNames_1.distFileNames)(),
        ...(0, extractAssetsPlugin_1.extractAssetsPlugin)(),
        (0, extractExportNamesPlugin_1.extractExportNamesPlugin)(),
        (0, suppressRollupWarning_1.suppressRollupWarning)(),
        (0, setGlobalContext_1.setGlobalContext)(),
        ...(0, importBuild_1.importBuild)(),
        (0, extensionsAssets_1.extensionsAssets)(),
        (0, baseUrls_1.baseUrls)(vpsConfig)
    ];
    return plugins;
}
exports.plugin = plugin;
exports.ssr = plugin;
// Enable `const ssr = require('vite-plugin-ssr/plugin')`
// This lives at the end of the file to ensure it happens after all assignments to `exports`
module.exports = Object.assign(exports.default, exports);
// Error upon wrong usage
Object.defineProperty(plugin, 'apply', {
    enumerable: true,
    get: () => {
        (0, utils_1.assertUsage)(false, 'Make sure to instantiate the `ssr` plugin (`import ssr from "vite-plugin-ssr"`): include `ssr()` instead of `ssr` in the `plugins` list of your `vite.config.js`.');
    }
});
