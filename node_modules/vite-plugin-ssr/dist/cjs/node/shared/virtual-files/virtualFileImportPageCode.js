"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getVirtualFileIdImportPageCode = exports.isVirtualFileIdImportPageCode = void 0;
const extractAssetsQuery_1 = require("../extractAssetsQuery");
const utils_1 = require("../utils");
const idBase = 'virtual:vite-plugin-ssr:importPageCode:';
const idBaseClient = `${idBase}client:`;
const idBaseServer = `${idBase}server:`;
function getVirtualFileIdImportPageCode(pageId, isForClientSide) {
    const id = (isForClientSide ? idBaseClient : idBaseServer) + pageId;
    return id;
}
exports.getVirtualFileIdImportPageCode = getVirtualFileIdImportPageCode;
function isVirtualFileIdImportPageCode(id) {
    id = (0, utils_1.getVirtualFileId)(id);
    if (!id.includes(idBase))
        return false;
    (0, utils_1.assert)(id.startsWith(idBase));
    const idOriginal = id;
    id = (0, extractAssetsQuery_1.extractAssetsRemoveQuery)(id);
    const isExtractAssets = idOriginal !== id;
    if (id.startsWith(idBaseClient)) {
        (0, utils_1.assert)(isExtractAssets === false);
        return {
            pageId: id.slice(idBaseClient.length),
            isForClientSide: true,
            isExtractAssets
        };
    }
    if (id.startsWith(idBaseServer)) {
        return {
            pageId: id.slice(idBaseServer.length),
            isForClientSide: false,
            isExtractAssets
        };
    }
    (0, utils_1.assert)(false);
}
exports.isVirtualFileIdImportPageCode = isVirtualFileIdImportPageCode;
