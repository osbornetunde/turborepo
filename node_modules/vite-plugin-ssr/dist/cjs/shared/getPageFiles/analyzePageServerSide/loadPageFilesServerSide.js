"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.loadPageFilesServerSide = void 0;
const getAllPageIdFiles_1 = require("../getAllPageIdFiles");
const getExports_1 = require("../getExports");
const loadPageCode_1 = require("../../page-configs/loadPageCode");
async function loadPageFilesServerSide(pageFilesAll, pageConfig, pageId, isDev) {
    const pageFilesServerSide = (0, getAllPageIdFiles_1.getPageFilesServerSide)(pageFilesAll, pageId);
    const pageConfigLoaded = !pageConfig ? null : await (0, loadPageCode_1.loadPageCode)(pageConfig, isDev);
    await Promise.all(pageFilesServerSide.map((p) => p.loadFile?.()));
    const { config, configEntries, exports, exportsAll, pageExports } = (0, getExports_1.getExports)(pageFilesServerSide, pageConfigLoaded);
    return {
        config,
        configEntries,
        exports,
        exportsAll,
        pageExports,
        pageFilesLoaded: pageFilesServerSide,
        pageConfigLoaded
    };
}
exports.loadPageFilesServerSide = loadPageFilesServerSide;
