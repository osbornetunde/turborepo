// Unit tests at ./freezePartial.spec.ts
export function freezePartial(obj, allowList) {
    Object.entries(obj).forEach(([key, val]) => {
        Object.defineProperty(obj, key, {
            get() {
                return val;
            },
            set(newVal) {
                if (key in allowList) {
                    const isAllowed = allowList[key](newVal);
                    if (isAllowed) {
                        val = newVal;
                        return;
                    }
                    else {
                        throw new Error(`Setting wrong value \`${newVal}\` for property \`${key}\``);
                    }
                }
                throw new Error(`You aren't allowed to mutate property \`${key}\``);
            },
            configurable: false,
            enumerable: true
        });
    });
    Object.preventExtensions(obj);
}
